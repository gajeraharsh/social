<div class="d-flex justify-content-between align-items-center mb-3">
  <h2 class="mb-0">Cron & Upload Logs</h2>
  <a class="btn btn-outline-secondary" href="/admin/dashboard">Back to Dashboard</a>
</div>

<div class="table-responsive">
  <table class="table table-striped align-middle">
    <thead>
      <tr>
        <th>Time</th>
        <th>Account</th>
        <th>Post</th>
        <th>Type</th>
        <th>Status</th>
        <th>Reason</th>
        <th>Cron</th>
      </tr>
    </thead>
    <tbody>
      <% if (logs && logs.length) { %>
        <% logs.forEach(l => { %>
          <tr>
            <td>
              <div class="small"><%= new Date(l.createdAt).toLocaleString() %></div>
              <div class="text-muted small">Start: <%= l.startedAt ? new Date(l.startedAt).toLocaleString() : '-' %> Â· End: <%= l.endedAt ? new Date(l.endedAt).toLocaleString() : '-' %></div>
            </td>
            <td><%= l.account ? l.account.username : '-' %></td>
            <td><%= l.post ? `${l.post.name}` : '-' %></td>
            <td><span class="badge bg-info text-dark text-uppercase"><%= l.type || '-' %></span></td>
            <td>
              <span class="badge <%= l.status === 'success' ? 'bg-success' : (l.status === 'failed' ? 'bg-danger' : 'bg-secondary') %>"><%= l.status %></span>
            </td>
            <td class="text-break" style="max-width: 280px;"><%= l.errorReason || '-' %></td>
            <td>
              <% if (l.cronRun) { %>
                <div class="small text-muted"><%= l.cronRun.cronExp %></div>
                <div class="small">Start: <%= new Date(l.cronRun.startedAt).toLocaleString() %></div>
              <% } else { %>
                <span class="text-muted">-</span>
              <% } %>
            </td>
          </tr>
        <% }) %>
      <% } else { %>
        <tr><td colspan="7" class="text-center">No logs found</td></tr>
      <% } %>
    </tbody>
  </table>
</div>

<nav aria-label="pagination">
  <ul class="pagination flex-wrap">
    <% const totalPages = pagination.pages; %>
    <% const current = pagination.page; %>
    <li class="page-item <%= current === 1 ? 'disabled' : '' %>">
      <a class="page-link" href="?page=<%= current - 1 %>&limit=<%= pagination.limit %>">Previous</a>
    </li>
    <% for (let i = 1; i <= totalPages; i++) { %>
      <li class="page-item <%= i === current ? 'active' : '' %>"><a class="page-link" href="?page=<%= i %>&limit=<%= pagination.limit %>"><%= i %></a></li>
    <% } %>
    <li class="page-item <%= current === totalPages ? 'disabled' : '' %>">
      <a class="page-link" href="?page=<%= current + 1 %>&limit=<%= pagination.limit %>">Next</a>
    </li>
  </ul>
</nav>
